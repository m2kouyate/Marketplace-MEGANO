{% extends 'base.html' %}
{% load static %}

{% block content %}
    <div class="Middle Middle_top">
        <div class="Section Section_column Section_columnLeft">
            <div class="wrap">
                <div class="Section-column">
                    <div class="Section-columnSection">
                        <header class="Section-header">
                            <strong class="Section-title">Навигация
                            </strong>
                        </header>
                        <div class="Section-columnContent">
                            <div class="NavigateProfile">
                                <ul class="menu menu_vt">
                                    <li class="menu-item_ACTIVE menu-item"><a class="menu-link" href="{% url "app_users:account" user.username %}">Личный кабинет</a>
                                    </li>
                                    <li class="menu-item"><a class="menu-link" href="{% url "app_users:profile_edit" user.username %}">Профиль</a>
                                    </li>
                                    <li class="menu-item"><a class="menu-link" href="{% url "app_users:orders_history" %}">История заказов</a>
                                    </li>
                                    <li class="menu-item"><a class="menu-link" href="{% url "app_users:views_history" user.username %}">История просмотра</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="Section-content">
                    <div class="Account">
                        <div class="Account-group">
                            <div class="Account-column">
                                <div class="Account-avatar">
                                    {% if user.profile.avatar %}
                                        <img src="{% static user.profile.avatar.image.file %}" alt="profile.png" />
                                    {% else %}
                                        <img src="{% static "assets/img/icons/profile.png" %}" alt="profile.png" />
                                    {% endif %}
                                </div>
                            </div>
                            <div class="Account-column">
                                <div class="Account-name">{{ user.profile.full_name }}
                                </div><a class="Account-editLink" href="{% url "app_users:profile_edit" user.username %}">Редактировать профиль</a>
                            </div>
                        </div>
                        <header class="Section-header">
                        <strong class="Section-title">Последний заказ
                        </strong>
                        </header>
                        <div class="Account-group">
                            {% if last_order %}
                                <div class="Account-column Account-column_full">
                                    <div class="Order Order_anons">
                                        <div class="Order-personal">
                                            <div class="row">
                                                <div class="row-block"><a class="Order-title" href="{% url "app_users:order_detail" last_order.id %}">Заказ&#32;<span class="Order-numberOrder">№{{ last_order.pk }}</span>&#32;от&#32;<span class="Order-dateOrder">{{ last_order.order_date|date:"d.m.Y" }}</span></a>
                                                    <div class="Account-editLink"><a href="{% url "app_users:orders_history" %}">История заказов</a>
                                                    </div>
                                                </div>
                                                <div class="row-block">
                                                    <div class="Order-info Order-info_delivery">
                                                        <div class="Order-infoType">Тип доставки:
                                                        </div>
                                                        <div class="Order-infoContent">{{ last_order.delivery_type }}
                                                        </div>
                                                    </div>
                                                    <div class="Order-info Order-info_pay">
                                                        <div class="Order-infoType">Оплата:
                                                        </div>
                                                        <div class="Order-infoContent">{{ last_order.payment }}
                                                        </div>
                                                    </div>
                                                    <div class="Order-info">
                                                        <div class="Order-infoType">Общая стоимость:
                                                        </div>
                                                        <div class="Order-infoContent">{{ last_order_cost }} рублей
                                                        </div>
                                                    </div>
                                                    <div class="Order-info Order-info_status">
                                                        <div class="Order-infoType">Статус оплаты:
                                                        </div>
                                                        <div class="Order-infoContent">{{ last_order.get_payment_status_display }}
                                                        </div>
                                                    </div>
                                                    <div class="Order-info Order-info_status">
                                                        <div class="Order-infoType">Статус доставки:
                                                        </div>
                                                        <div class="Order-infoContent">{{ last_order.get_order_status_display }}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                        <header class="Section-header">
                        <strong class="Section-title">Последние просмотренные товары
                        </strong>
                            <div class="Account-editLink"><a href="{% url "app_users:views_history" user.username %}">История просмотра</a>
                            </div>
                        </header>
                        <div class="Account-group">
                            <div class="Cards">
                                {% for product in last_views %}
                                <div class="Card"><a class="Card-picture" href="{% url 'pages:product-detail' product.pk %}"><img src="/{% firstof product.icon.file 'static/assets/img/content/home/card.jpg' %}" alt="card.jpg" /></a>
                                    <div class="Card-content">
                                        <strong class="Card-title"><a href="{% url 'pages:product-detail' product.pk %}">{{ product.title }}</a>
                                        </strong>
                                        <div class="Card-description">
                                            <div class="Card-cost"><span class="Card-price">от {{ product.min_price }} руб.</span>
                                            </div>
                                            <div class="Card-category">{{ product.category.title }}
                                            </div>
                                            <div class="Card-hover"><a class="Card-btn" href="#"><img src="{% static 'assets/img/icons/card/cart.svg' %}" alt="cart.svg" /></a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% empty %}
                                <img src="{% static 'assets/img/content/home/no_res.png' %}" alt="no_results" width="450"/>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
